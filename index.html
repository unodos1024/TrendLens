<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrendLens | AI 블로그 뉴스 수집기</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Noto+Sans+KR:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>

<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar" id="sidebar">
            <button id="toggleSidebar" class="toggle-sidebar-btn" title="사이드바 접기/펴기">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M15 18l-6-6 6-6"></path>
                </svg>
            </button>
            <div class="logo-area">
                <div class="logo-icon"></div>
                <h1>TrendLens</h1>
            </div>

            <nav class="side-nav">
                <button class="nav-item active" data-page="news">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path
                            d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z">
                        </path>
                    </svg>
                    <span>뉴스 검색</span>
                </button>
                <button class="nav-item" data-page="collection">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 21l-7-5-7 5V5a2 2 0 012-2h10a2 2 0 012 2z"></path>
                    </svg>
                    <span>수집함</span>
                </button>
                <button class="nav-item" data-page="searchTrend">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                    </svg>
                    <span>검색어 트렌드</span>
                </button>
                <button class="nav-item" data-page="shoppingTrend">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4H6z"></path>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <path d="M16 10a4 4 0 01-8 0"></path>
                    </svg>
                    <span>쇼핑 인사이트</span>
                </button>
                <button class="nav-item" data-page="settings">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path
                            d="M12 1v6m0 6v6m5.656-13.364l-1.414 1.414m-8.484 8.484l-1.414 1.414M23 12h-6m-6 0H5m13.364 5.656l-1.414-1.414M7.05 7.05L5.636 5.636">
                        </path>
                    </svg>
                    <span>설정</span>
                </button>
            </nav>

            <div class="sidebar-footer">
                <p>© 2026 TrendLens AI</p>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="top-header">
                <div class="status-badge">
                    <span class="dot"></span>
                    <span id="statusText">준비 완료</span>
                </div>
            </header>

            <!-- News Search Page -->
            <section class="page active" id="newsPage">
                <div class="search-controls">
                    <div class="control-row">
                        <div class="control-group">
                            <label>데이터 출처</label>
                            <select id="source">
                                <option value="naver">네이버 뉴스 (기본)</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>수집 개수</label>
                            <select id="displayCount">
                                <option value="10">10개</option>
                                <option value="20" selected>20개</option>
                                <option value="50">50개</option>
                                <option value="100">100개</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>필터</label>
                            <select id="sort">
                                <option value="sim">정확도순</option>
                                <option value="date">최신순</option>
                            </select>
                        </div>
                    </div>
                    <div class="control-row">
                        <div class="control-group flex-grow">
                            <label>검색 키워드</label>
                            <input type="text" id="keyword" placeholder="키워드를 입력하세요...">
                        </div>
                        <button id="searchBtn" class="btn-primary">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2.5">
                                <circle cx="11" cy="11" r="8"></circle>
                                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                            </svg>
                            <span>수집 시작</span>
                        </button>
                    </div>
                </div>
                <div class="results-area" id="resultsArea">
                    <div class="empty-state">
                        <div class="empty-icon">📰</div>
                        <h2>수집된 뉴스가 없습니다</h2>
                        <p>키워드를 입력하고 수집을 시작해 보세요.</p>
                    </div>
                </div>
            </section>

            <!-- Collection Page -->
            <section class="page" id="collectionPage">
                <div class="page-header">
                    <h2>📌 수집함</h2>
                    <p>저장한 기사 목록입니다</p>
                </div>
                <div class="results-area" id="collectionArea"></div>
            </section>

            <!-- Search Trend Page -->
            <section class="page" id="searchTrendPage">
                <div id="searchTrendView" class="trend-view">
                    <div class="trend-compact-controls">
                        <!-- Row 1: Period and Basic Filters (Larger) -->
                        <div class="controls-row main-filters-row">
                            <div class="filter-item period-group">
                                <label>기간</label>
                                <select id="trendTimeUnit">
                                    <option value="date" selected>일간</option>
                                    <option value="week">주간</option>
                                    <option value="month">월간</option>
                                </select>
                                <div id="trendDateWrapper" class="date-inputs">
                                    <input type="date" id="trendStartDate">
                                    <span>~</span>
                                    <input type="date" id="trendEndDate">
                                </div>
                            </div>

                            <div class="filter-item check-group-large">
                                <label>범위</label>
                                <div class="checkbox-list larger-checks">
                                    <label><input type="checkbox" class="check-all" data-target="trendDevice" checked>
                                        전체</label>
                                    <label><input type="checkbox" name="trendDevice" value="pc"> PC</label>
                                    <label><input type="checkbox" name="trendDevice" value="mo"> 모바일</label>
                                </div>
                            </div>

                            <div class="filter-item check-group-large">
                                <label>성별</label>
                                <div class="checkbox-list larger-checks">
                                    <label><input type="checkbox" class="check-all" data-target="trendGender" checked>
                                        전체</label>
                                    <label><input type="checkbox" name="trendGender" value="m"> 남</label>
                                    <label><input type="checkbox" name="trendGender" value="f"> 여</label>
                                </div>
                            </div>
                        </div>

                        <!-- Row 2: Ages (Larger) -->
                        <div class="controls-row age-full-row">
                            <div class="filter-item age-group-large">
                                <label>연령</label>
                                <div class="age-checkbox-container large-age">
                                    <label><input type="checkbox" class="check-all" data-target="trendAge" checked>
                                        전체</label>
                                    <label><input type="checkbox" name="trendAge" value="1"> 0~12</label>
                                    <label><input type="checkbox" name="trendAge" value="2"> 13~18</label>
                                    <label><input type="checkbox" name="trendAge" value="3"> 19~24</label>
                                    <label><input type="checkbox" name="trendAge" value="4"> 25~29</label>
                                    <label><input type="checkbox" name="trendAge" value="5"> 30~34</label>
                                    <label><input type="checkbox" name="trendAge" value="6"> 35~39</label>
                                    <label><input type="checkbox" name="trendAge" value="7"> 40~44</label>
                                    <label><input type="checkbox" name="trendAge" value="8"> 45~49</label>
                                    <label><input type="checkbox" name="trendAge" value="9"> 50~54</label>
                                    <label><input type="checkbox" name="trendAge" value="10"> 55-59</label>
                                    <label><input type="checkbox" name="trendAge" value="11"> 60+</label>
                                </div>
                            </div>
                        </div>

                        <!-- Row 3: Keywords -->
                        <div class="controls-row keywords-full-row">
                            <div id="fixedKeywordGrid" class="keyword-input-line-fixed">
                                <input type="text" class="keyword-input" placeholder="비교 키워드 1" data-index="0">
                                <input type="text" class="keyword-input" placeholder="비교 키워드 2" data-index="1">
                                <input type="text" class="keyword-input" placeholder="비교 키워드 3" data-index="2">
                                <input type="text" class="keyword-input" placeholder="비교 키워드 4" data-index="3">
                                <input type="text" class="keyword-input" placeholder="비교 키워드 5" data-index="4">
                            </div>
                        </div>

                        <!-- Row 4: Analysis Button -->
                        <div class="controls-row action-row">
                            <button id="analyzeTrendBtn" class="btn-primary full-width-btn">트렌드 분석 시작</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="trendChart"></canvas>
                    </div>
                    <div class="trend-info">
                        <p>💡 최근 한 달간의 검색어 트렌드 추이 (통합 검색)</p>
                    </div>
                </div>
            </section>

            <!-- Shopping Trend Page -->
            <section class="page" id="shoppingTrendPage">
                <div id="shoppingTrendView" class="trend-view">
                    <div class="trend-compact-controls">
                        <!-- Row 1: Categories -->
                        <div class="controls-row main-filters-row">
                            <div class="filter-item category-group">
                                <label>분야</label>
                                <select id="shoppingCat1">
                                    <option value="">1분류 선택</option>
                                    <option value="50000000">패션의류</option>
                                    <option value="50000001">패션잡화</option>
                                    <option value="50000002">화장품/미용</option>
                                    <option value="50000003">디지털/가전</option>
                                    <option value="50000004">가구/인테리어</option>
                                    <option value="50000005">출산/육아</option>
                                    <option value="50000006">식품</option>
                                    <option value="50000007">스포츠/레저</option>
                                    <option value="50000008">생활/건강</option>
                                    <option value="50000009">여가/생활편의</option>
                                    <option value="50000010">면세점</option>
                                </select>
                                <span class="divider-arrow">></span>
                                <select id="shoppingCat2">
                                    <option value="">2분류 선택</option>
                                </select>
                            </div>
                        </div>

                        <!-- Row 2: Period, Device, Gender -->
                        <div class="controls-row main-filters-row">
                            <div class="filter-item period-group">
                                <label>기간</label>
                                <select id="shoppingTimeUnit">
                                    <option value="date" selected>일간</option>
                                    <option value="week">주간</option>
                                    <option value="month">월간</option>
                                </select>
                                <div id="shoppingDateWrapper" class="date-inputs">
                                    <input type="date" id="shoppingStartDate">
                                    <span>~</span>
                                    <input type="date" id="shoppingEndDate">
                                </div>
                            </div>

                            <div class="filter-item check-group-large">
                                <label>기기</label>
                                <div class="checkbox-list larger-checks">
                                    <label><input type="checkbox" class="check-all" data-target="shoppingDevice"
                                            checked> 전체</label>
                                    <label><input type="checkbox" name="shoppingDevice" value="pc"> PC</label>
                                    <label><input type="checkbox" name="shoppingDevice" value="mo"> 모바일</label>
                                </div>
                            </div>

                            <div class="filter-item check-group-large">
                                <label>성별</label>
                                <div class="checkbox-list larger-checks">
                                    <label><input type="checkbox" class="check-all" data-target="shoppingGender"
                                            checked> 전체</label>
                                    <label><input type="checkbox" name="shoppingGender" value="m"> 남</label>
                                    <label><input type="checkbox" name="shoppingGender" value="f"> 여</label>
                                </div>
                            </div>
                        </div>

                        <!-- Row 3: Ages (Large) -->
                        <div class="controls-row age-full-row">
                            <div class="filter-item age-group-large">
                                <label>연령</label>
                                <div class="age-checkbox-container large-age">
                                    <label><input type="checkbox" class="check-all" data-target="shoppingAge" checked>
                                        전체</label>
                                    <label><input type="checkbox" name="shoppingAge" value="10"> 10대</label>
                                    <label><input type="checkbox" name="shoppingAge" value="20"> 20대</label>
                                    <label><input type="checkbox" name="shoppingAge" value="30"> 30대</label>
                                    <label><input type="checkbox" name="shoppingAge" value="40"> 40대</label>
                                    <label><input type="checkbox" name="shoppingAge" value="50"> 50대</label>
                                    <label><input type="checkbox" name="shoppingAge" value="60"> 60대+</label>
                                </div>
                            </div>
                        </div>

                        <!-- Row 4: Action Button -->
                        <div class="controls-row action-row">
                            <button id="analyzeShoppingBtn" class="btn-primary full-width-btn">쇼핑 데이터 분석 시작</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="shoppingChart"></canvas>
                    </div>
                    <div class="trend-info">
                        <p>🛍️ 네이버 쇼핑 인사이트 - 카테고리별 클릭 트렌드</p>
                    </div>
                </div>
            </section>

            <!-- Settings Page -->
            <section class="page" id="settingsPage">
                <div class="page-header">
                    <h2>⚙️ 설정</h2>
                    <p>API 및 데이터 출처 관리</p>
                </div>
                <div class="settings-content">
                    <button id="manageApisBtn" class="btn-secondary">공공데이터 API 관리</button>
                    <div id="apiConfigList" class="api-config-list"></div>
                </div>
            </section>
        </main>
    </div>

    <!-- Toast UI -->
    <div id="toast" class="toast"></div>

    <!-- AI Draft Modal -->
    <div id="draftModal" class="modal">
        <div class="modal-content">
            <header class="modal-header">
                <h2>✍️ AI 블로그 초안 생성</h2>
                <button class="close-btn" id="closeModal">&times;</button>
            </header>
            <div class="modal-body">
                <!-- Step 1: Article Preview & Start Button -->
                <div id="draftInitialView" class="draft-initial-view">
                    <div class="article-preview">
                        <h3 id="previewTitle"></h3>
                        <p id="previewDesc"></p>
                    </div>
                    <button id="startAiDraftBtn" class="btn-primary" style="margin: 2rem auto; width: fit-content;">AI
                        블로그 글 작성 시작하기</button>
                </div>

                <!-- Step 2: Content Area (Includes Loading) -->
                <div id="draftResultView" class="draft-result-view"
                    style="display: none; position: relative; min-height: 200px;">
                    <div id="draftLoading" class="loading-overlay" style="display: none;">
                        <div class="spinner"></div>
                        <p>AI가 글을 작성하고 있습니다...</p>
                    </div>
                    <div class="draft-container">
                        <div class="draft-header">
                            <label>추천 제목</label>
                            <input type="text" id="draftTitle" placeholder="생성 중...">
                        </div>
                        <div class="draft-body">
                            <label>본문 내용</label>
                            <textarea id="draftText" placeholder="AI가 내용을 구성하고 있습니다..."></textarea>
                        </div>
                        <div class="draft-tags">
                            <label>추천 태그</label>
                            <div id="draftTagList" class="tag-list"></div>
                        </div>
                    </div>
                </div>
            </div>
            <footer class="modal-footer" id="modalFooter" style="display: none;">
                <button id="copyDraftBtn" class="btn-secondary">클립보드 복사</button>
                <button id="postTistoryBtn" class="btn-primary">Tistory에 게시</button>
            </footer>
        </div>
    </div>

    <!-- API Management Modal -->
    <div id="apiModal" class="modal">
        <div class="modal-content">
            <header class="modal-header">
                <h2>🌐 공공데이터 API 등록/관리</h2>
                <button class="close-api-btn" id="closeApiModal">&times;</button>
            </header>
            <div class="modal-body">
                <div class="api-list-section">
                    <h3>등록된 API 목록</h3>
                    <div id="apiConfigListModal" class="api-config-list"></div>
                </div>
                <hr class="divider">
                <div class="api-form-section">
                    <h3>새 API 등록</h3>
                    <form id="apiConfigForm" class="api-form">
                        <input type="hidden" id="configId">
                        <div class="form-row">
                            <div class="form-group">
                                <label>API 명칭</label>
                                <input type="text" id="configName" placeholder="예: 문체부 정책브리핑" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Endpoint URL (JSON 응답 주소)</label>
                                <input type="url" id="configUrl" placeholder="http://apis.data.go.kr/..." required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>인증키 (Service Key)</label>
                                <input type="text" id="configKey" placeholder="공공데이터포털에서 발급받은 키" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>키워드 파라미터명</label>
                                <input type="text" id="configKeyword" placeholder="예: keyword, query" required>
                            </div>
                            <div class="form-group">
                                <label>데이터 경로 (Item Path)</label>
                                <input type="text" id="configPath" placeholder="예: body.items (생략가능)">
                            </div>
                        </div>
                        <div class="form-row mapping-group">
                            <label>필드 매핑 (API상의 필드명을 입력)</label>
                            <div class="mapping-inputs">
                                <input type="text" id="mapTitle" placeholder="제목 필드(title)">
                                <input type="text" id="mapLink" placeholder="링크 필드(link)">
                                <input type="text" id="mapDesc" placeholder="설명 필드(description)">
                            </div>
                        </div>
                        <button type="submit" id="saveApiBtn" class="btn-primary">API 저장하기</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="main.js"></script>
</body>

</html>